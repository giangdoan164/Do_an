function Banner(e) { this.obj = e; this.aNodes = []; this.currentBanner = 0 } function Node(e, t, n, r, i, s, o) { this.name = e; this.bannerType = t; this.bannerPath = n; this.bannerDuration = r; this.height = i; this.width = s; this.hyperlink = o } Banner.prototype.add = function (e, t, n, r, i, s) { this.aNodes[this.aNodes.length] = new Node(this.obj + "_" + this.aNodes.length, e, t, n, r, i, s) }; Banner.prototype.toString = function () { var e = ""; for (var t = 0; t < this.aNodes.length; t++) { e = e + '<span name="' + this.aNodes[t].name + '" '; e = e + 'id="' + this.aNodes[t].name + '" '; e = e + 'class="m_banner_hide" '; e = e + 'bgcolor="#FFFCDA" '; e = e + 'align="center" '; e = e + 'valign="top" >\n'; if (this.aNodes[t].hyperlink != "") { e = e + '<a target="_blank" href="' + this.aNodes[t].hyperlink + '">' } if (this.aNodes[t].bannerType == "FLASH") { e = e + "<OBJECT "; e = e + 'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" '; e = e + 'codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" '; e = e + 'WIDTH="' + this.aNodes[t].width + '" '; e = e + 'HEIGHT="' + this.aNodes[t].height + '" '; e = e + 'id="bnr_' + this.aNodes[t].name + '" '; e = e + 'ALIGN="" '; e = e + "VIEWASTEXT>"; e = e + '<PARAM NAME=movie VALUE="' + this.aNodes[t].bannerPath + '">'; e = e + "<PARAM NAME=quality VALUE=high>"; e = e + "<PARAM NAME=wmode VALUE=transparent>"; e = e + "<PARAM NAME=bgcolor VALUE=#FFFCDA>"; e = e + "<EMBED "; e = e + 'src="' + this.aNodes[t].bannerPath + '" '; e = e + "quality=high "; e = e + "wmode=transparent "; e = e + 'WIDTH="' + this.aNodes[t].width + '" '; e = e + 'HEIGHT="' + this.aNodes[t].height + '" '; e = e + 'NAME="bnr_' + this.aNodes[t].name + '" '; e = e + 'ALIGN="center" '; e = e + 'TYPE="application/x-shockwave-flash" '; e = e + 'PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer">'; e = e + "</EMBED>"; e = e + "</OBJECT>" } else if (this.aNodes[t].bannerType == "IMAGE") { e = e + '<img src="' + this.aNodes[t].bannerPath + '" '; e = e + 'border="0" '; e = e + 'height="' + this.aNodes[t].height + '" '; e = e + 'width="' + this.aNodes[t].width + '">' } if (this.aNodes[t].hyperlink != "") { e = e + "</a>" } e += "</span>" } return e }; Banner.prototype.start = function () { this.changeBanner(); var e = this.obj; setTimeout(e + ".start()", this.aNodes[this.currentBanner].bannerDuration * 1e3) }; Banner.prototype.changeBanner = function () { var e; var t = -1; if (this.currentBanner < this.aNodes.length) { e = this.currentBanner; if (this.aNodes.length > 1) { if (e > 0) { t = e - 1 } else { t = this.aNodes.length - 1 } } if (this.currentBanner < this.aNodes.length - 1) { this.currentBanner = this.currentBanner + 1 } else { this.currentBanner = 0 } } if (t >= 0) { document.getElementById(this.aNodes[t].name).className = "m_banner_hide" } document.getElementById(this.aNodes[e].name).className = "m_banner_show" }